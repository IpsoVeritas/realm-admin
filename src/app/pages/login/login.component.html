<div class="container">
  <app-stripe></app-stripe>
  <div class="header">
    <img src="assets/img/integrity_colour_landscape.svg" height="50%">
  </div>
  <div class="content">

    <div #realmPopupTrigger (click)="showRealmList()">Popup</div>

    <mat-expansion-panel class="mat-elevation-z0">
      <mat-expansion-panel-header>
        <mat-panel-title *ngIf="activeRealm">
          <div class="description">
            {{'login.login_to' | translate:{value:activeDescriptor && activeDescriptor.description ? activeDescriptor.description : activeRealm}
            }}
          </div>
          <div class="realm" *ngIf="activeDescriptor && activeDescriptor.description">
            {{ activeRealm }}
          </div>
        </mat-panel-title>
        <mat-panel-title *ngIf="!activeRealm" translate>login.enter_realm</mat-panel-title>
      </mat-expansion-panel-header>
      <form [formGroup]="realmForm" (ngSubmit)="onSubmit()">
        <mat-form-field>
          <input formControlName="realm" matInput placeholder="{{ 'entities.Realm' | translate }}">
          <mat-error *ngIf="realm.errors && realm.errors['required']" translate>login.realm_required</mat-error>
          <mat-error *ngIf="realm.errors && realm.errors['startAuthFailed']" translate>login.realm_invalid</mat-error>
        </mat-form-field>
        <button type="submit" mat-raised-button [disabled]="realmForm.invalid" color="accent">{{ 'general.change_realm' | translate }}</button>
      </form>
    </mat-expansion-panel>
    <integrity-qrcode *ngIf="qrUri" [qrdata]="qrUri" [integrityClipboard]="qrUri" (copySuccess)="showCopySuccess($event)"></integrity-qrcode>
    <div *ngIf="qrUri" class="instructions">
      {{'login.app_instructions' | translate:{value:activeDescriptor && activeDescriptor.description ? activeDescriptor.description
      : activeRealm} }}
    </div>
    <mat-progress-bar *ngIf="qrUri" mode="determinate" [value]="qrCountdown" color="accent"></mat-progress-bar>
  </div>
</div>
